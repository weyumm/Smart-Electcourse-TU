<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‰ˆæœ¬ä¿¡æ¯ - Tongji-Electcourse2</title>

    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="styles/theme.css"/><!-- ä¸»é¢˜æ ·å¼ -->
    <link rel="stylesheet" href="styles/link.css"/><!-- é“¾æ¥æ ·å¼ -->
    <link rel="stylesheet" href="styles/modal.css"/><!-- é€šç”¨æ¨¡æ€æ¡†æ ·å¼ -->
    <link rel="stylesheet" href="styles/scrollbar.css"/><!-- æ»šåŠ¨æ¡æ ·å¼ -->

    <style>
        /* =============== å…¨å±€ =============== */
        *{box-sizing:border-box;}
        body{
            font-family:var(--font);
            background:var(--bg-color);
            color:var(--text-color);
            margin:0;
            padding:20px;
            display:flex;
            flex-direction:column;
            min-height:100vh;
            transition:background .3s,color .3s;
        }

        /* å¡ç‰‡ */
        .card{
            background:var(--card-bg);
            backdrop-filter:blur(10px);
            border-radius:12px;
            box-shadow:0 8px 24px var(--shadow);
            padding:24px 32px;
            margin:0 auto 1.75rem;
            max-width:680px;
            transition:background .3s,box-shadow .3s;
        }
        h1{text-align:center;margin-top:0;margin-bottom:1.5rem;color:var(--text-color);}

        button {
        font-family: var(--font);
        background: var(--accent);
        color: #fff;
        border: none;
        border-radius: 6px;
        padding: 8px 16px;
        cursor: pointer;
        transition: background 0.2s, transform 0.1s;
        }
        button:hover { background: shade(var(--accent), 0.9); transform: translateY(-1px); }
        button:active { transform: translateY(0); }

        /* ç‰ˆæœ¬ä¿¡æ¯åˆ—è¡¨ */
        .version-list{
            list-style:none;
            padding:0;
            margin:0;
            font-size:1.05rem;
            line-height:1.9;
        }
        .version-list li{
            display:flex;
            justify-content:space-between;
            border-bottom:1px dashed var(--divider,#e0e0e0);
            padding:.25rem 0;
        }
        .version-list strong{color:var(--accent);font-weight:600;}

        /* åº•éƒ¨ */
        footer{
            margin-top:auto;
            text-align:center;
            font-size:.9rem;
            color:var(--text-color);
        }
        footer a{color:var(--accent);text-decoration:none;}
        footer a:hover{text-decoration:underline;}
    </style>
</head>
<body>
    <!-- ===== ä¸»é¢˜åˆ‡æ¢ ===== -->
    <div class="theme-toggle">
        <button class="theme-btn" id="lightBtn">â˜€ï¸</button>
        <button class="theme-btn" id="darkBtn">ğŸŒ™</button>
        <button class="theme-btn" id="blueBtn">ğŸŒŠ</button>
        <button class="theme-btn" id="greenBtn">ğŸƒ</button>
        <button class="theme-btn" id="purpleBtn">ğŸ¨</button>
    </div>

    <!-- ===== ç‰ˆæœ¬ä¿¡æ¯ ===== -->
    <div class="card">
    <h1>è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯</h1>
    <ul class="version-list">
        <li><strong>è½¯ä»¶ç‰ˆæœ¬</strong><span id="ver">å¾…è·å–</span></li>
        <li><strong>æ„å»ºæ—¥æœŸ</strong><span id="build">å¾…è·å–</span></li>
        <li><strong>API&nbsp;ç‰ˆæœ¬</strong><span id="api">å¾…è·å–</span></li>
        <li><strong>UI&nbsp;ç‰ˆæœ¬</strong><span id="ui">å¾…è·å–</span></li>
        <li><strong>çŠ¶æ€</strong><span id="status">å¾…è·å–</span></li>
    </ul>
        <div style="text-align:center;margin-top:1.5rem;">
            <button onclick="getVersionInfo()" style="padding:.5rem 1rem;font-size:1rem;border:none;border-radius:6px;background:var(--accent);color:#fff;cursor:pointer;">ç‚¹å‡»è·å–ç‰ˆæœ¬ä¿¡æ¯</button>
        </div>
    </div>

    <footer>
        <p>Copyright Â© 2025 Tongji-Electcourse2</p>
        <!-- è¿”å›ä¸»ç•Œé¢ -->
        <p><a href="system.html">è¿”å›ä¸»ç•Œé¢</a></p>
    </footer>

    <!-- é”™è¯¯ä¿¡æ¯å¼¹çª— -->
    <div id="modal-error" class="modal-overlay">
    <div class="modal">
        <div class="modal-header">
        <h3>Tongji-Electcourse2</h3>
        <button class="modal-close" onclick="hideErrorModal()">Ã—</button>
        </div>
        <div class="modal-body" id="modal-error-body">
        <!-- é”™è¯¯ä¿¡æ¯ç”± JS å¡«å…… -->
        </div>
        <div class="modal-footer">
        <button onclick="hideErrorModal()">ç¡®å®š</button>
        </div>
    </div>
    </div>

    <!-- ä¸»é¢˜åˆ‡æ¢è„šæœ¬ -->
    <script src="scripts/theme.js"></script>

    <!-- ===== ç‰ˆæœ¬ä¿¡æ¯è·å–è„šæœ¬ ===== -->
    <script>
function showErrorModal(msg) {
  document.getElementById('modal-error-body').innerHTML = msg;
  document.getElementById('modal-error').classList.add('active');
}
function hideErrorModal() {
  document.getElementById('modal-error').classList.remove('active');
}

    </script>
    <script>
function getVersionInfo() {
    const placeholders = ['ver','build','api','ui','status'];

    // è¶…æ—¶æç¤ºï¼ˆåç«¯ç‰ˆæœ¬è¿‡è€ï¼‰
    const timeoutId = setTimeout(() => {
        showErrorModal(
            'å½“å‰è½¯ä»¶ç‰ˆæœ¬è¿‡è€ï¼Œæš‚ä¸æ”¯æŒè·å–ç‰ˆæœ¬ä¿¡æ¯åŠŸèƒ½ã€‚<br>' +
            'è¯·è®¿é—® <a href="https://github.com/boatchanting/Tongji-electcourse2/releases" target="_blank">é¡¹ç›®å‘å¸ƒé¡µ</a> ä»¥è·å–æœ€æ–°ç‰ˆæœ¬ã€‚'
        );
        placeholders.forEach(id => {
            document.getElementById(id).textContent = 'æš‚ä¸å¯ç”¨';
        });
    }, 300); // 300msæ— å“åº”å°±è¶…æ—¶

    // å¦‚æœåç«¯ä¸å­˜åœ¨
    if (!(window.pywebview && window.pywebview.api)) {
        clearTimeout(timeoutId);
        showErrorModal(
            'å½“å‰è½¯ä»¶ç‰ˆæœ¬è¿‡è€ï¼Œæš‚ä¸æ”¯æŒè·å–ç‰ˆæœ¬ä¿¡æ¯åŠŸèƒ½ã€‚<br>' +
            'è¯·è®¿é—® <a href="https://github.com/boatchanting/Tongji-electcourse2/releases" target="_blank">é¡¹ç›®å‘å¸ƒé¡µ</a> ä»¥è·å–æœ€æ–°ç‰ˆæœ¬ã€‚'
        );
        placeholders.forEach(id => {
            document.getElementById(id).textContent = 'æš‚ä¸å¯ç”¨';
        });
        return;
    }

    // æ­£å¸¸è·å–ç‰ˆæœ¬ä¿¡æ¯
    window.pywebview.api.get_version()
        .then(info => {
            clearTimeout(timeoutId); // æˆåŠŸå‰æ¸…é™¤è¶…æ—¶åˆ¤æ–­
            if (!info) return;
            document.getElementById('ver').textContent    = info.version      ?? '-';
            document.getElementById('build').textContent  = info.build_date   ?? '-';
            document.getElementById('api').textContent    = info.api_version  ?? '-';
            document.getElementById('ui').textContent     = info.ui_version   ?? '-';
            document.getElementById('status').textContent = info.status       ?? '-';
        })
        .catch(err => {
            clearTimeout(timeoutId);
            console.error('è·å–ç‰ˆæœ¬ä¿¡æ¯å¤±è´¥:', err);
            showErrorModal('è·å–ç‰ˆæœ¬ä¿¡æ¯å¤±è´¥ï¼Œè¯·ç¡®è®¤åç«¯å·²æ­£ç¡®åŠ è½½ï¼Œæˆ–ç¨åé‡è¯•ã€‚');
            placeholders.forEach(id => {
                document.getElementById(id).textContent = 'æ— æ³•è¯»å–';
            });
        });
}


</script>

</body>
</html>